<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" type="image/jpeg" href="photos/her8.jpeg" />
<title>A Small Question</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Quicksand:wght@300;500&display=swap" rel="stylesheet" />

<style>
:root{
    --sky:#dff4ff;
    --blue:#9edcff;
    --text:#2c3e50;
}

body{
    margin:0;
    background:linear-gradient(#eaf9ff,#dff4ff);
    font-family:'Quicksand',sans-serif;
    text-align:center;
    height:100vh;
    overflow:hidden;
    color:var(--text);
    position:relative;
}

/* floating pixels background */
body::before{
    content:"";
    position:fixed;
    inset:0;
    background-image:
        radial-gradient(#ffffffaa 2px,transparent 2px),
        radial-gradient(#bde7ff 1px,transparent 1px);
    background-size:60px 60px,30px 30px;
    animation:float 60s linear infinite;
    opacity:.6;
    pointer-events:none;
    z-index:-2;
}

@keyframes float{
    from{background-position:0 0,0 0}
    to{background-position:1000px 600px,-800px 400px}
}

/* scattered photos */
.scattered{
    position:fixed;
    inset:0;
    pointer-events:auto;
    z-index:-1;
}

.scatter{
    position:absolute;
    width:140px;
    filter:drop-shadow(8px 12px 0 #3b6d94) brightness(1.05);
    image-rendering:auto;
    transition:transform .4s ease;
    cursor:pointer;
}

.scatter:hover{
    transform:scale(1.08) rotate(0deg);
}

.s1{ top:8%; left:6%; transform:rotate(-8deg); }
.s2{ top:18%; right:10%; transform:rotate(7deg); }
.s3{ bottom:12%; left:14%; transform:rotate(5deg); }

.s4{ bottom:8%; right:12%; transform:rotate(-6deg); }

/* initial scattered photos */
.initialScatter{ display:block; }
.successScreenActive .initialScatter{ display:none; }

/* success page scattered photos */
.successScatter{ display:none; }
.successScreenActive .successScatter{ display:block; }

.ss1{ top:8%; left:6%; transform:rotate(-6deg); 
    width:200px;
}
.ss2{ top:12%; right:6%; transform:rotate(6deg);
    width:200px;
}
.ss3{ bottom:12%; left:10%; transform:rotate(5deg);
    width:200px;
}

/* centered main photo under text */
.ssCenter{
    position:absolute;
    left:50%;
    bottom:8%;
    transform:translateX(-50%);
    width:300px;
    filter:drop-shadow(12px 16px 0 #3b6d94) brightness(1.05);
}

/* main layout */
.container{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    gap:18px;
    position:relative;
    z-index:2;
    pointer-events:none;
}

.container *{
    pointer-events:auto;
}

.actions{
    display:flex;
    gap:24px;
    justify-content:center;
    align-items:center;
}

h1{
    font-family:'Press Start 2P',cursive;
    font-size:26px;
    line-height:2em;
    color:#3b6d94;
    margin:0;
}

button{
    font-family:'Press Start 2P';
    padding:20px 40px;
    margin:22px;
    border:5px solid #3b6d94;
    background:#bde7ff;
    color:#24506f;
    cursor:pointer;
    box-shadow:8px 8px 0 #3b6d94;
    transition:.15s;
    font-size:18px;
}

button:hover{
    transform:translate(2px,2px);
    box-shadow:4px 4px 0 #3b6d94;
}

.noDisabled{
    background:#d3d7dc;
    color:#7a8a96;
    border-color:#7a8a96;
    box-shadow:6px 6px 0 #7a8a96;
    cursor:not-allowed;
}

.noDisabled:hover{
    transform:none;
    box-shadow:6px 6px 0 #7a8a96;
}

#noBtn{ position:relative; }

/* falling hearts + roses */
.fall{
    position:fixed;
    top:-40px;
    opacity:.35;
    animation:drift var(--dur,20s) linear infinite;
    pointer-events:none;
    z-index:10001;
}

.heart{
    font-size:16px;
    filter:drop-shadow(1px 1px 0 #3b6d94aa);
}

.burst{
    position:fixed;
    left:0;
    top:0;
    font-size:20px;
    pointer-events:none;
    animation:burstUp 1s ease-out forwards;
    z-index:3;
}

@keyframes burstUp{
    from{ transform:translate(0,0) scale(0.6); opacity:1 }
    to{ transform:translate(var(--dx),var(--dy)) scale(1.2); opacity:0 }
}

@keyframes drift{
    from{transform:translateY(-20px)}
    to{transform:translateY(110vh)}
}

/* drawing area */
#drawArea{
    display:none;
    margin-top:30px;
}

canvas{
    background:white;
    border:6px solid #3b6d94;
    box-shadow:10px 10px 0 #3b6d94;
    touch-action:none;
}

#result{
    font-family:'Press Start 2P';
    margin-top:30px;
    font-size:16px;
    color:#ff3b6f;
    animation:shake 0.4s;
}

@keyframes shake{
    0%{transform:translateX(0)}
    25%{transform:translateX(-6px)}
    50%{transform:translateX(6px)}
    75%{transform:translateX(-6px)}
    100%{transform:translateX(0)}
}

/* success screen (hidden until verified) */
#successScreen{
    display:none;
}

#successScreen .message{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    position:relative;
    z-index:2;
    color:#3b6d94;
    font-family:'Press Start 2P';
    gap:20px;
}

#successScreen p{
    font-family:Quicksand;
    margin-top:10px;
    font-size:26px;
    color:var(--text);
}

.finalHeart{
    width:220px;
    height:auto;
    margin-bottom:20px;
    margin-top: -150px;
    border:8px solid #ff4d88;
    border-radius:22px;
    background:white;
    box-shadow:10px 10px 0 #3b6d94;
}

/* mobile adjustments (INSIDE style) */
@media (max-width: 600px){
    .scatter{
        width:90px;
        opacity:0.85;
    }

    .s1{ top:4%; left:2%; }
    .s2{ top:10%; right:2%; }
    .s3{ bottom:8%; left:4%; }
    .s4{ bottom:6%; right:4%; }

    h1{ font-size:18px; }

    button{
        padding:14px 22px;
        font-size:14px;
        margin:14px;
    }

    #successScreen p{
        font-size:20px;
        margin-top:28px;
        padding:0 16px;
    }

    body{
        overflow:auto;
    }

    canvas{
        width:90vw;
        height:90vw;
        max-width:380px;
        max-height:380px;
    }

    #drawArea{
        margin-top:12px;
        padding-bottom:80px;
    }

    .scatter{
        opacity:0.6;
    }
}

#mobileBlock{
    position:fixed;
    inset:0;
    background:linear-gradient(#eaf9ff,#dff4ff);
    opacity:1;
    display:none;
    align-items:center;
    justify-content:center;
    text-align:center;
    z-index:9999;
}

.mobileMessage{
    font-family:'Press Start 2P';
    color:#3b6d94;
    display:flex;
    flex-direction:column;
    gap:24px;
    padding:40px;
}

.mobileMessage p{
    font-family:'Quicksand';
    font-size:18px;
}
</style>
</head>

<body>

<div id="mobileBlock">
    <div class="mobileMessage">
        <h1>ðŸ’™ ðŸŒ¹ ðŸ’™<br><br><br><br><br>do NOT open this website on your computer.<br><br><br><br><br>ðŸ’™ ðŸŒ¹ ðŸ’™</h1>
    </div>
</div>

<!-- initial page photos -->
<div class="scattered initialScatter" aria-hidden="true">
    <img src="photos/her1.png" class="scatter s1" alt="" />
    <img src="photos/her2.png" class="scatter s2" alt="" />
    <img src="photos/her3.png" class="scatter s3" alt="" />
    <img src="photos/her4.png" class="scatter s4" alt="" />
</div>

<!-- success screen photos -->
<div class="scattered successScatter" aria-hidden="true">
    <img src="photos/her5.png" class="scatter ss1" alt="" />
    <img src="photos/her6.png" class="scatter ss2" alt="" />
    <img src="photos/her7.png" class="scatter ssCenter" alt="" />
</div>

<div class="container" id="mainScreen">
    <h1 id="title">thalia nguyen-khoa,<br><br>will you be my valentine?</h1>

    <div class="actions" id="actions">
        <button id="yesBtn">YES</button>
        <button id="noBtn">NO</button>
    </div>

    <div id="drawArea">
        <h1>human verification required</h1>
        <p>please draw a heart to continue</p>
        <canvas id="canvas" width="380" height="380"></canvas><br>
        <button id="verifyBtn">VERIFY</button>
        <div id="result"></div>
    </div>
</div>

<div id="successScreen">
    <div class="message">
        <img id="finalHeart" class="finalHeart" alt="your heart" />
        <h1>verification complete</h1>
        <h1>you are now my valentine ðŸ’™</h1>
        <p>there is no undo button. <br> i love youuuuuuuuu</p>

        <small>make sure to send Ajay Shah a screenshot of this verification!!</small>
    </div>
</div>

<script>
const isMobile = /Android|iPhone|iPad|iPod|Mobile/i.test(navigator.userAgent);
if(isMobile){
    document.addEventListener("DOMContentLoaded", ()=>{
        document.getElementById("mobileBlock").style.display="flex";
        document.body.style.overflow="hidden";
    });
}

if(!isMobile){
/* elements */
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const drawArea = document.getElementById("drawArea");
const title = document.getElementById("title");
const actions = document.getElementById("actions");
const mainScreen = document.getElementById("mainScreen");
const successScreen = document.getElementById("successScreen");
const verifyBtn = document.getElementById("verifyBtn");

/* runaway NO button */
let noActivated=false;
noBtn.onmouseover = () => {
    if(!noActivated){
        noActivated=true;
        noBtn.classList.add("noDisabled");
    }
    noBtn.style.position = "absolute";
    noBtn.style.left = Math.random()*(window.innerWidth-120)+"px";
    noBtn.style.top = Math.random()*(window.innerHeight-80)+"px";
};

// Also gray out on click for mobile taps
noBtn.onclick = () => {
    if(!noActivated){
        noActivated=true;
        noBtn.classList.add("noDisabled");
    }
};

/* YES pressed */
yesBtn.onclick = () => {
    title.innerText = "security checkpoint";
    actions.style.display = "none";
    drawArea.style.display = "block";
};

/* drawing logic */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let drawing = false;
let points = [];

function getPos(e){
    const rect = canvas.getBoundingClientRect();
    const t = e.touches ? e.touches[0] : null;
    const clientX = t ? t.clientX : e.clientX;
    const clientY = t ? t.clientY : e.clientY;
    return { x: clientX - rect.left, y: clientY - rect.top };
}

function start(e){
    drawing = true;
    points = [];
    const p = getPos(e);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
}

function move(e){
    if(!drawing) return;
    const p = getPos(e);
    ctx.lineTo(p.x, p.y);
    ctx.strokeStyle = "#ff4d88";
    ctx.lineWidth = 4;
    ctx.stroke();
    points.push([p.x, p.y]);
}

function end(){
    drawing = false;
}

canvas.addEventListener("mousedown", start);
canvas.addEventListener("mousemove", move);
canvas.addEventListener("mouseup", end);

canvas.addEventListener("touchstart", start, { passive: true });
canvas.addEventListener("touchmove", (e) => { move(e); e.preventDefault(); }, { passive: false });
canvas.addEventListener("touchend", end);

function emptyFail(){
    const r = document.getElementById("result");
    r.innerText = "WHERE'S MY HEART?????";
    r.style.animation = "none";
    void r.offsetWidth;
    r.style.animation = "shake 0.4s";
    ctx.clearRect(0,0,canvas.width,canvas.height);
    points = [];
}

function badFail(){
    const r = document.getElementById("result");
    r.innerText = "that's a terrible heart, what happened to your art skills?";
    r.style.animation = "none";
    void r.offsetWidth;
    r.style.animation = "shake 0.4s";
    ctx.clearRect(0,0,canvas.width,canvas.height);
    points = [];
}

function success(){
    mainScreen.style.display = "none";
    successScreen.style.display = "block";
    document.body.classList.add("successScreenActive");
    const finalHeart = document.getElementById("finalHeart");
    finalHeart.src = canvas.toDataURL("image/png");
    celebrate();
}

function checkHeart(){
    if(points.length < 10){
        emptyFail();
        return;
    }

    let minY = 999, maxY = 0, minX = 999, maxX = 0;
    for(const p of points){
        minX = Math.min(minX, p[0]);
        maxX = Math.max(maxX, p[0]);
        minY = Math.min(minY, p[1]);
        maxY = Math.max(maxY, p[1]);
    }

    const ratio = (maxY - minY) / (maxX - minX);
    const lowest = points.reduce((a,b)=> a[1] > b[1] ? a : b);
    const above = points.filter(p => p[1] < lowest[1] - (maxY-minY)*0.3).length;

    if(ratio > 0.8 && ratio < 1.6 && above > 40) success();
    else badFail();
}

verifyBtn.addEventListener("click", checkHeart);

}
/* subtle falling hearts + roses, with immediate start */
const emojis = ["ðŸ’™","ðŸŒ¹","ðŸ’™","ðŸŒ¹","ðŸ’™"];

function spawnParticle(){
    const el = document.createElement("div");
    el.classList.add("fall","heart");
    el.innerText = emojis[Math.floor(Math.random()*emojis.length)];
    el.style.left = Math.random()*100 + "vw";
    el.style.setProperty('--dur', (18 + Math.random()*12) + "s");
    document.body.appendChild(el);
    setTimeout(()=>el.remove(), 30000);
}

for(let i=0;i<6;i++){
    setTimeout(spawnParticle, i*180);
}

setInterval(spawnParticle, 2200);

function celebrate(){
    const centerX = window.innerWidth/2;
    const centerY = window.innerHeight/2;
    for(let i=0;i<40;i++){
        const el=document.createElement("div");
        el.classList.add("burst","heart");
        el.innerText="ðŸ’™";
        const dx=(Math.random()*400-200)+"px";
        const dy=(Math.random()*400-200)+"px";
        el.style.left=centerX+"px";
        el.style.top=centerY+"px";
        el.style.setProperty('--dx',dx);
        el.style.setProperty('--dy',dy);
        document.body.appendChild(el);
        setTimeout(()=>el.remove(),1000);
    }
}
</script>

</body>
</html>
